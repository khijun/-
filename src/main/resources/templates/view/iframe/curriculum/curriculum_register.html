<!DOCTYPE html>
<html lang="ko">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css"/>
   <link rel="stylesheet" href="/css/iframe/curriculum/subject/toastUi_grid.css"> <!-- 공통 CSS 적용 -->
   <title>교육과정 등록</title>
</head>
<body>
<div>
   <div class="list-option-container">
      <button id="add-row-btn">행 추가</button>
      <button id="delete-row-btn">행 삭제</button>
      <button id="save-curriculums-btn">저장</button>
   </div>
   <div id="curriculum-grid-container" style="height: 700px;"></div>
</div>

<script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>
<script>
    const grid = new tui.Grid({
        el: document.getElementById('curriculum-grid-container'),
        data: [],
        columns: [
            {header: '학과 ID', name: 'deptId', editor: 'text', align: 'center', width: 100},
            {header: '교육과정명', name: 'curriculumName', editor: 'text', align: 'center', width: 200},
            {header: '연도', name: 'curriculumYear', editor: 'text', align: 'center', width: 100},
            {header: '학년', name: 'grade', editor: 'text', align: 'center', width: 100},
            {header: '상태', name: 'curriculumStatus', editor: 'text', align: 'center', width: 150},
            {header: '학기', name: 'semester', editor: 'text', align: 'center', width: 100},
            {header: '주야 구분', name: 'dayNight', editor: 'text', align: 'center', width: 100},
            {header: '사유', name: 'reason', editor: 'text', width: 300}
        ],
        bodyHeight: 'fitToParent',
        rowHeaders: ['checkbox'],
        editingEvent: 'click'
    });

    document.getElementById("add-row-btn").addEventListener("click", () => {
        grid.appendRow({});
    });

    document.getElementById("delete-row-btn").addEventListener("click", () => {
        grid.removeCheckedRows();
    });

    document.getElementById("save-curriculums-btn").addEventListener("click", () => {
        const rows = grid.getCheckedRows();
        if (rows.length === 0) {
            alert("저장할 행을 선택하세요.");
            return;
        }

        fetch("/api/curriculums", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(rows)
        })
            .then(response => response.json())
            .then(data => alert("교육과정이 등록되었습니다!"))
            .catch(error => console.error("Error saving curriculums:", error));
    });
</script>
</body>
</html>
